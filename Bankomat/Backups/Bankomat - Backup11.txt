#include <iostream>
#include <windows.h>
#include <cstdlib>
#include <math.h>
#include <conio.h>
#include <string>
#include <map>
#include <fstream>
#include <vector>

using namespace std;

//  Sizes
const unsigned int GUIX = 47;
const unsigned int GUIY = 20;

//  Corners
const char cr1 = (char)(218);
const char cr2 = (char)(191);
const char cr3 = (char)(192);
const char cr4 = (char)(217);


///---------------------------------GUI TEMPLATES--------------------------------------------------------------------------------------------------------------------------------------------------

char EmptyGUI[GUIY][GUIX] =
{
//   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47
    ' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',    // 0
    ' ','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#',' ',    // 1
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 2
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 3
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 4
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 5
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 6
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 7
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 8
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 9
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 10
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 11
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 12
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 13
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 14
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 15
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 16
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 17
    ' ','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#',' ',    // 18
    ' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '     // 19
};

char StartGUI[GUIY][GUIX] =
{
//   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47
    ' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',    // 0
    ' ','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#',' ',    // 1
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 2
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#',' ',' ','#','#','#','#','#',' ','#','#',' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 3
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#',' ',' ',' ','#',' ',' ',' ','#',' ',' ',' ','#',' ','#',' ','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 4
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#','#','#',' ',' ',' ','#',' ',' ',' ','#',' ','#',' ','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 5
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#',' ',' ',' ','#',' ',' ',' ','#',' ',' ',' ','#',' ',' ',' ','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 6
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#',' ',' ',' ','#',' ',' ',' ','#',' ',' ',' ','#',' ',' ',' ','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 7
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 8
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 9
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 10
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 11
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 12
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 13
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 14
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 15
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 16
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 17
    ' ','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#',' ',    // 18
    ' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '     // 19
};

char BankGUI[GUIY][GUIX] =
{
//   1   2   3   4   5   6   7   8   9   10  11  12  13  14  15  16  17  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44  45  46  47
    ' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',    // 0
    ' ','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#',' ',    // 1
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 2
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#',' ',' ',' ','#','#','#',' ',' ','#',' ',' ',' ','#',' ','#',' ',' ','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 3
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#',' ',' ','#',' ','#',' ',' ',' ','#',' ','#','#',' ',' ','#',' ','#',' ','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 4
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#',' ',' ','#','#','#','#','#',' ','#',' ','#',' ','#',' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 5
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#',' ',' ','#',' ','#',' ',' ',' ','#',' ','#',' ',' ','#','#',' ','#',' ','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 6
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#',' ',' ','#',' ',' ',' ','#',' ','#',' ',' ',' ','#',' ','#',' ',' ','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 7
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 8
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 9
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 10
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 11
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 12
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 13
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 14
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 15
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 16
    ' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',    // 17
    ' ','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#',' ',    // 18
    ' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' '     // 19
};


///---------------------------------GLOBAL VALUES--------------------------------------------------------------------------------------------------------------------------------------------------

string Language = "EN";
fstream Account;
fstream Casket;
string CardsPath = "Bank\\Cards";
string AccountsPath = "Bank\\Accounts";
string CasketPath = "Casket.txt";
string CurrentPath;
string CurrentAccount;  //  Only for card operation in Bank


///---------------------------------TEXTS----------------------------------------------------------------------------------------------------------------------------------------------------------

map<string, string> insertCardText;
map<string, string> adminText;
map<string, string> backText;
map<string, string> exitText;
map<string, string> finishText;

map<string, string> depositText;
map<string, string> cardNumberText;
map<string, string> depositMoneyText;
map<string, string> insertMoneyText;
map<string, string> moneyInsertedText;
map<string, string> moneyInsertErrorText;
map<string, string> endingText;
map<string, string> TakeOutCardText;

map<string, string> withdrawText;
map<string, string> customText;
map<string, string> withdrawInfoText;
map<string, string> withdrawAmount;

map<string, string> wrongNumberText;

map<string, string> emptyText;
map<string, string> successText;
map<string, string> successDescText;
map<string, string> failureText;
map<string, string> failureDescText;
map<string, string> failureDescText2;
map<string, string> casketMoneyErrorText;


map<string, string> bankText;
map<string, string> enterText;

map<string, string> passwordText;
map<string, string> insertPasswordText;
map<string, string> wrongPasswordText;

map<string, string> accountText;
map<string, string> casketText;
map<string, string> backToBankText;

map<string, string> setMoneyText;
map<string, string> moneySetText;
map<string, string> moneySetErrorText;

map<string, string> insertAccountNumberText;
map<string, string> loginText;

map<string, string> cardsMenuText;
map<string, string> moneyText;
map<string, string> deleteText;

map<string, string> setAccountMoneyText;
map<string, string> moneySetedText;
map<string, string> notEnoughMoneyText;


///---------------------------------EMPTY FUNCTIONS------------------------------------------------------------------------------------------------------------------------------------------------

void ChangeGUIToStart();
void ChangeGUIToInsertCard();
void placeholderAction();
void placeholderAction2();
void CardInput();
void PasswordInput();


///---------------------------------MAIN CLASSES---------------------------------------------------------------------------------------------------------------------------------------------------

class Box{
protected:
    map<string, string> text;
    map<string, string> placeholderText;
    string type;
    Box *T, *R, *B, *L;
    bool centered, visible, secret, frame, selected;
    unsigned int startX, startY, lenX, lenY;
    void (*ButtonAction)();
    void (*ButtonAction2)(string);
    void (*TextLabelAction)(string);

public:
    char** Out;

    Box(){}

    virtual Box* Switch(char side){}

    virtual void setSelect(bool isSelected){}

    virtual string getText(){}

    virtual string getInputedText(){}

    virtual void setText(map<string, string> txt){}

    virtual void inputText(char c){}

    virtual void subInputText(){}

    virtual void clearInput(){}

    virtual void setOutput(){}

    virtual void setOutputText(){}

    virtual void printBox(){}

    virtual int getStartX(){}

    virtual int getStartY(){}

    virtual int getLen(){}

    virtual bool isVisible(){}

    virtual void setVisible(bool _visible){}

    virtual void setT(Box *box){}

    virtual void setR(Box *box){}

    virtual void setB(Box *box){}

    virtual void setL(Box *box){}

    virtual void setPlaceholderText(string placeholder){}

    virtual string getType(){}

    virtual void setButtonAction2(){}

    virtual void doAction(){}

    virtual void setA2(){}

    virtual ~Box(){
        L = nullptr;
        R = nullptr;
        T = nullptr;
        B = nullptr;

        if (Out != nullptr) {
            for (unsigned int i = 0; i < lenY; ++i) {
                delete Out[i];
                Out[i] = nullptr;
            }
            delete[] Out;
            Out = nullptr;
        }
    }
};

class Button : public Box{
private:
    string smallPlaceholderText = "";
    bool a2;
public:
    Button(unsigned int sx,
            unsigned int sy,
            unsigned int lX,
            bool centeredText = true,
            Box* Top = nullptr,
            Box* Right = nullptr,
            Box* Bottom = nullptr,
            Box* Left = nullptr,
            bool _visible = true,
            bool _secret = false,
            bool haveFrame = true)
    {
        a2 = false;
        type = "Button";

        visible = _visible;
        secret = _secret;
        frame = haveFrame;
        selected = false;

        T = Top;
        R = Right;
        B = Bottom;
        L = Left;
        centered = centeredText;

        startX = sx;
        startY = sy;
        lenX = lX;
        lenY = 3;

        Out = new char*[lenY];
        for(unsigned int i=0; i<lenY; i++)
            Out[i] = new char[lenX];
        setOutput();
    }

    Box* Switch(char side){
        switch(side){
        case 'T':
            if(T != nullptr && T->isVisible())
                return T;
            else
                return this;
        case 'R':
            if(R != nullptr && R->isVisible())
                return R;
            else
                return this;
        case 'B':
            if(B != nullptr && B->isVisible())
                return B;
            else
                return this;
        case 'L':
            if(L != nullptr && L->isVisible())
                return L;
            else
                return this;
        default:
            cout<<"ERROR 404 - NO SIDE AS "<<side<<"!"<<endl;
            return this;
        }
    }

    void setSelect(bool isSelected){
        selected = isSelected;
    }

    string getText(){
        return text[Language];
    }

    void setText(map<string, string> txt){
        text = txt;
        setOutputText();
    }

    void setPlaceholderText(string placeholder){
        smallPlaceholderText = placeholder;
    }

    void setOutput(){
        if (Out != nullptr) {
            for (unsigned int i = 0; i < lenY; i++) {
                if (Out[i] != nullptr) {
                    delete[] Out[i];
                    Out[i] = nullptr;
                }
            }
        }
        delete[] Out;
        Out = nullptr;

        Out = new char*[lenY];
        for(unsigned int i=0; i<lenY; i++){
            Out[i] = new char[lenX];
            for(unsigned int j=0; j<lenX; j++){
                if(i==0){
                    if(frame){
                        if(j == 0)
                            Out[i][j] = cr1;
                        else if(j == lenX-1)
                            Out[i][j] = cr2;
                        else{
                            if(secret){
                                if((lenX-j)%2==1)
                                    Out[i][j] = '-';
                                else
                                    Out[i][j] = ' ';
                            }
                            else
                                Out[i][j] = '-';
                        }
                    }
                    else{
                        Out[i][j] = ' ';
                    }
                }
                else if(i==2){
                    if(frame){
                        if(j == 0)
                            Out[i][j] = cr3;
                        else if(j == lenX-1)
                            Out[i][j] = cr4;
                        else{
                            if(secret){
                                if((lenX-j)%2==1)
                                    Out[i][j] = '-';
                                else
                                    Out[i][j] = ' ';
                            }
                            else
                                Out[i][j] = '-';
                        }
                    }
                    else{
                        Out[i][j] = ' ';
                    }
                }
                else{
                    if(j == 0 || j == lenX-1){
                        if(secret || !frame)
                            Out[i][j] = ' ';
                        else
                            Out[i][j] = '|';
                    }
                    else
                        Out[i][j] = ' ';
                }
            }
        }
        setOutputText();
    }

    void setOutputText(){
        int i=0;
        string txt = text[Language], placeholderTxt = smallPlaceholderText;
        int len = txt.length();
        int margin = round((lenX-4 - len)/2);

        for(unsigned int j=2; j<lenX-2; j++)
            Out[1][j] = ' ';

        if(len>0){
            if(centered){
                for(unsigned int j=2+margin; j<lenX-2; j++){
                    if(i<len){
                        Out[1][j] = txt[i];
                        i++;
                    }
                    else
                        Out[1][j] = ' ';
                }
            }
            else{
                for(int j = 2; j<lenX-3; j++){
                    if(i<len){
                        Out[1][j] = txt[i];
                        i++;
                    }
                    else
                        Out[1][j] = ' ';
                }
            }
        }
        else{
            len = placeholderTxt.length();
            if(centered){
                for(unsigned int j=2+margin; j<lenX-2; j++){
                    if(i<len){
                        Out[1][j] = placeholderTxt[i];
                        i++;
                    }
                }
            }
            else{
                for(int j = 2; j<lenX-3; j++){
                    if(i<len){
                        Out[1][j] = placeholderTxt[i];
                        i++;
                    }
                }
            }
        }
    }

    void printBox(){
        if(visible){
            cout << "\033[" << startY << ";" << startX << "H";
            cout << "\033[7m";
            if(selected)
                cout << "\033[44m";
            for(unsigned int i=0; i<lenY; i++){
                for(unsigned int j=0; j<lenX; j++){
                    cout << Out[i][j];
                }
                cout << "\033[1B" << "\033[" << lenX << "D";
            }
            cout << "\033[0m";
        }
    }

    int getStartX(){
        return startX;
    }

    int getStartY(){
        return startY;
    }

    int getLen(){
        return lenX;
    }

    bool isVisible(){
        return visible;
    }

    void setVisible(bool _visible){
        visible = _visible;
    }

    void setT(Box *box){
        T = box;
    }

    void setR(Box *box){
        R = box;
    }

    void setB(Box *box){
        B = box;
    }

    void setL(Box *box){
        L = box;
    }

    string getType(){
        return type;
    }

    void setButtonAction(void (*newAction)()){
        ButtonAction = newAction;
    }

    void setButtonAction2(void (*newAction)(string)){
        ButtonAction2 = newAction;
    }

    void setA2(bool a){
        a2 = a;
    }

    void doAction(){
        if(a2){
            doAction2();
            return;
        }

        ButtonAction();
    }

    void doAction2(){
        ButtonAction2(smallPlaceholderText);
    }

    ~Button(){
        L = nullptr;
        R = nullptr;
        T = nullptr;
        B = nullptr;

        if (Out != nullptr) {
            for (unsigned int i = 0; i < lenY; ++i) {
                delete[] Out[i];
                Out[i] = nullptr;
            }
            delete[] Out;
            Out = nullptr;
        }
    }
};

class TextLabel : public Box{
private:
    string inputedText;
public:
    TextLabel(unsigned int sx,
            unsigned int sy,
            unsigned int lX,
            bool centeredText = true,
            Box* Top = nullptr,
            Box* Right = nullptr,
            Box* Bottom = nullptr,
            Box* Left = nullptr,
            bool _visible = true,
            bool _secret = false,
            bool haveFrame = true)
    {
        type = "TextLabel";

        visible = _visible;
        secret = _secret;
        frame = haveFrame;
        selected = false;

        T = Top;
        R = Right;
        B = Bottom;
        L = Left;
        centered = centeredText;

        startX = sx;
        startY = sy;
        lenX = lX;
        lenY = 3;

        Out = new char*[lenY];
        for(unsigned int i=0; i<lenY; i++)
            Out[i] = new char[lenX];
        setOutput();
    }

    Box* Switch(char side){
        switch(side){
        case 'T':
            if(T != nullptr && T->isVisible())
                return T;
            else
                return this;
        case 'R':
            if(R != nullptr && R->isVisible())
                return R;
            else
                return this;
        case 'B':
            if(B != nullptr && B->isVisible())
                return B;
            else
                return this;
        case 'L':
            if(L != nullptr && L->isVisible())
                return L;
            else
                return this;
        default:
            cout<<"ERROR 404 - NO SIDE AS "<<side<<"!"<<endl;
            return this;
        }
    }

    void setSelect(bool isSelected){
        selected = isSelected;
    }

    string getText(){
        return text[Language];
    }

    string getInputedText(){
        return inputedText;
    }

    void inputText(char c){
        inputedText+=c;
        setOutputText();
    }

    void subInputText(){
        inputedText.pop_back();
        setOutputText();
    }

    void clearInput(){
        inputedText = "";
    }

    void setText(map<string, string> txt){
        text = txt;
    }

    void setOutput(){
        if (Out != nullptr) {
            for (unsigned int i = 0; i < lenY; i++) {
                if (Out[i] != nullptr) {
                    delete[] Out[i];
                    Out[i] = nullptr;
                }
            }
        }
        delete[] Out;

        Out = new char*[lenY];
        for(unsigned int i=0; i<lenY; i++){
            Out[i] = new char[lenX];
            for(unsigned int j=0; j<lenX; j++){
                if(i==0){
                    if(frame){
                        if(j == 0)
                            Out[i][j] = cr1;
                        else if(j == lenX-1)
                            Out[i][j] = cr2;
                        else{
                            if(secret){
                                if((lenX-j)%2==1)
                                    Out[i][j] = '-';
                                else
                                    Out[i][j] = ' ';
                            }
                            else
                                Out[i][j] = '-';
                        }
                    }
                    else{
                        Out[i][j] = ' ';
                    }
                }
                else if(i==2){
                    if(frame){
                        if(j == 0)
                            Out[i][j] = cr3;
                        else if(j == lenX-1)
                            Out[i][j] = cr4;
                        else{
                            if(secret){
                                if((lenX-j)%2==1)
                                    Out[i][j] = '-';
                                else
                                    Out[i][j] = ' ';
                            }
                            else
                                Out[i][j] = '-';
                        }
                    }
                    else{
                        Out[i][j] = ' ';
                    }
                }
                else{
                    if(j == 0 || j == lenX-1){
                        if(secret || !frame)
                            Out[i][j] = ' ';
                        else
                            Out[i][j] = '|';
                    }
                    else
                        Out[i][j] = ' ';
                }
            }
        }
        setOutputText();
    }

    void setOutputText(){
        int i=0;
        string placeholderTxt = placeholderText[Language];
        int len = inputedText.length();
        int margin = round((lenX-4 - len)/2);

        for(unsigned int j=2; j<lenX-2; j++)
            Out[1][j] = ' ';

        if(len>0){
            if(centered){
                for(unsigned int j=2+margin; j<lenX-2; j++){
                    if(i<len){
                        Out[1][j] = inputedText[i];
                        i++;
                    }
                    else
                        Out[1][j] = ' ';
                }
            }
            else{
                for(int j = 2; j<lenX-3; j++){
                    if(i<len){
                        Out[1][j] = inputedText[i];
                        i++;
                    }
                    else
                        Out[1][j] = ' ';
                }
            }
        }
        else{
            len = placeholderTxt.length();
            if(centered){
                for(unsigned int j=2+margin; j<lenX-2; j++){
                    if(i<len){
                        Out[1][j] = placeholderTxt[i];
                        i++;
                    }
                }
            }
            else{
                for(int j = 2; j<lenX-3; j++){
                    if(i<len){
                        Out[1][j] = placeholderTxt[i];
                        i++;
                    }
                }
            }
        }
    }

    void printBox(){
        if(visible){
            cout << "\033[" << startY << ";" << startX << "H";
            cout << "\033[7m";
            if(selected)
                cout << "\033[44m";
            for(unsigned int i=0; i<lenY; i++){
                for(unsigned int j=0; j<lenX; j++){
                    cout << Out[i][j];
                }
                cout << "\033[1B" << "\033[" << lenX << "D";
            }
            cout << "\033[0m";
        }
    }

    int getStartX(){
        return startX;
    }

    int getStartY(){
        return startY;
    }

    int getLen(){
        return lenX;
    }

    bool isVisible(){
        return visible;
    }

    void setVisible(bool _visible){
        visible = _visible;
    }

    void setT(Box *box){
        T = box;
    }

    void setR(Box *box){
        R = box;
    }

    void setB(Box *box){
        B = box;
    }

    void setL(Box *box){
        L = box;
    }

    void setPlaceholderText(map<string, string> placeholder){
        placeholderText = placeholder;
    }

    string getType(){
        return type;
    }

    void setTextLabelAction(void (*newAction)(string)){
        TextLabelAction = newAction;
    }

    void doAction(){
        TextLabelAction(inputedText);
        Sleep(100);
    }

    ~TextLabel(){
        L = nullptr;
        R = nullptr;
        T = nullptr;
        B = nullptr;

        if (Out != nullptr) {
            for (unsigned int i = 0; i < lenY; i++) {
                delete Out[i];
                Out[i] = nullptr;
            }
            delete[] Out;
            Out = nullptr;
        }
    }
};

class TextBox : public Box{
public:
    TextBox(unsigned int sx,
            unsigned int sy,
            unsigned int lX,
            bool centeredText = true,
            Box* Top = nullptr,
            Box* Right = nullptr,
            Box* Bottom = nullptr,
            Box* Left = nullptr,
            bool _visible = true,
            bool _secret = false,
            bool haveFrame = false)
    {
        type = "TextBox";

        visible = _visible;
        secret = _secret;
        frame = haveFrame;
        selected = false;

        T = Top;
        R = Right;
        B = Bottom;
        L = Left;
        centered = centeredText;

        startX = sx;
        startY = sy;
        lenX = lX;
        lenY = 3;

        Out = new char*[lenY];
        for(int i=0; i<lenY; i++)
            Out[i] = new char[lenX];
        setOutput();
    }

    Box* Switch(char side){
        switch(side){
        case 'T':
            if(T != nullptr && T->isVisible())
                return T;
            else
                return this;
        case 'R':
            if(R != nullptr && R->isVisible())
                return R;
            else
                return this;
        case 'B':
            if(B != nullptr && B->isVisible())
                return B;
            else
                return this;
        case 'L':
            if(L != nullptr && L->isVisible())
                return L;
            else
                return this;
        default:
            cout<<"ERROR 404 - NO SIDE AS "<<side<<"!"<<endl;
            return this;
        }
    }

    string getText(){
        return text[Language];
    }

    void setText(map<string, string> txt){
        text = txt;
    }

    void setOutput(){
        if (Out != nullptr) {
            for (unsigned int i = 0; i < lenY; i++) {
                if (Out[i] != nullptr) {
                    delete[] Out[i];
                    Out[i] = nullptr;
                }
            }
        }
        delete[] Out;

        Out = new char*[lenY];
        for(unsigned int i=0; i<lenY; i++){
            Out[i] = new char[lenX];
            for(unsigned int j=0; j<lenX; j++)
                Out[i][j] = ' ';
        }
        setOutputText();
    }

    void setOutputText(){
        int i=0;
        string txt = text[Language], placeholderTxt = placeholderText[Language];
        int len = txt.length();
        int margin = round((lenX-4 - len)/2);

        for(unsigned int j=2; j<lenX-2; j++)
            Out[1][j] = ' ';

        if(len>0){
            if(centered){
                for(unsigned int j=2+margin; j<lenX-2; j++){
                    if(i<len){
                        Out[1][j] = txt[i];
                        i++;
                    }
                    else
                        Out[1][j] = ' ';
                }
            }
            else{
                for(int j = 2; j<lenX-3; j++){
                    if(i<len){
                        Out[1][j] = txt[i];
                        i++;
                    }
                    else
                        Out[1][j] = ' ';
                }
            }
        }
        else{
            len = placeholderTxt.length();
            if(centered){
                for(unsigned int j=2+margin; j<lenX-2; j++){
                    if(i<len){
                        Out[1][j] = placeholderTxt[i];
                        i++;
                    }
                }
            }
            else{
                for(int j = 2; j<lenX-3; j++){
                    if(i<len){
                        Out[1][j] = placeholderTxt[i];
                        i++;
                    }
                }
            }
        }
    }

    void printBox(){
        if(visible){
            cout << "\033[" << startY << ";" << startX << "H";
            cout << "\033[7m";
            if(selected)
                cout << "\033[44m";
            for(unsigned int i=0; i<lenY; i++){
                for(unsigned int j=0; j<lenX; j++){
                    cout << Out[i][j];
                }
                cout << "\033[1B" << "\033[" << lenX << "D";
            }
            cout << "\033[0m";
        }
    }

    int getStartX(){
        return startX;
    }

    int getStartY(){
        return startY;
    }

    int getLen(){
        return lenX;
    }

    bool isVisible(){
        return visible;
    }

    void setVisible(bool _visible){
        visible = _visible;
    }

    void setT(Box *box){
        T = box;
    }

    void setR(Box *box){
        R = box;
    }

    void setB(Box *box){
        B = box;
    }

    void setL(Box *box){
        L = box;
    }

    string getType(){
        return type;
    }

    ~TextBox(){
        L = nullptr;
        R = nullptr;
        T = nullptr;
        B = nullptr;

        if (Out != nullptr) {
            for (unsigned int i = 0; i < lenY; ++i) {
                delete[] Out[i];
                Out[i] = nullptr;
            }
            delete[] Out;
            Out = nullptr;
        }
    }
};

class LangBox : public Box{
private:
    string currentLang = "EN";

public:
    LangBox(unsigned int sx,
            unsigned int sy,
            unsigned int lX,
            bool centeredText = true,
            Box* Top = nullptr,
            Box* Right = nullptr,
            Box* Bottom = nullptr,
            Box* Left = nullptr,
            bool _visible = true,
            bool _secret = false,
            bool haveFrame = true)
    {
        type = "LangBox";
        currentLang = "EN";

        text["EN"] = "EN";
        text["PL"] = "PL";

        visible = _visible;
        secret = _secret;
        frame = haveFrame;
        selected = false;

        T = Top;
        R = Right;
        B = Bottom;
        L = Left;
        centered = centeredText;

        startX = sx;
        startY = sy;
        lenX = lX;
        lenY = 3;

        Out = new char*[lenY];
        for(int i=0; i<lenY; i++)
            Out[i] = new char[lenX];
        setOutput();
    }

    changeLang(){
        if(currentLang == "EN")
            currentLang = "PL";
        else
            currentLang = "EN";

        Language = currentLang;
        setPlaceholderText(currentLang);
        setOutputText();
    }

    Box* Switch(char side){
        switch(side){
        case 'T':
            if(T != nullptr && T->isVisible())
                return T;
            else
                return this;
        case 'R':
            if(R != nullptr && R->isVisible())
                return R;
            else
                return this;
        case 'B':
            if(B != nullptr && B->isVisible())
                return B;
            else
                return this;
        case 'L':
            if(L != nullptr && L->isVisible())
                return L;
            else
                return this;
        default:
            cout<<"ERROR 404 - NO SIDE AS "<<side<<"!"<<endl;
            return this;
        }
    }

    void setSelect(bool isSelected){
        selected = isSelected;
    }

    string getText(){
        return text[Language];
    }

    void setOutput(){
        if (Out != nullptr) {
            for (unsigned int i = 0; i < lenY; i++) {
                if (Out[i] != nullptr) {
                    delete[] Out[i];
                    Out[i] = nullptr;
                }
            }
        }
        delete[] Out;

        Out = new char*[lenY];
        for(unsigned int i=0; i<lenY; i++){
            Out[i] = new char[lenX];
            for(unsigned int j=0; j<lenX; j++){
                if(i==0){
                    if(frame){
                        if(j == 0)
                            Out[i][j] = cr1;
                        else if(j == lenX-1)
                            Out[i][j] = cr2;
                        else{
                            if(secret){
                                if((lenX-j)%2==1)
                                    Out[i][j] = '-';
                                else
                                    Out[i][j] = ' ';
                            }
                            else
                                Out[i][j] = '-';
                        }
                    }
                    else{
                        Out[i][j] = ' ';
                    }
                }
                else if(i==2){
                    if(frame){
                        if(j == 0)
                            Out[i][j] = cr3;
                        else if(j == lenX-1)
                            Out[i][j] = cr4;
                        else{
                            if(secret){
                                if((lenX-j)%2==1)
                                    Out[i][j] = '-';
                                else
                                    Out[i][j] = ' ';
                            }
                            else
                                Out[i][j] = '-';
                        }
                    }
                    else{
                        Out[i][j] = ' ';
                    }
                }
                else{
                    if(j == 0 || j == lenX-1){
                        if(secret || !frame)
                            Out[i][j] = ' ';
                        else
                            Out[i][j] = '|';
                    }
                    else
                        Out[i][j] = ' ';
                }
            }
        }
        setOutputText();
    }

    void setOutputText(){
        int i=0;
        string txt = text[Language], placeholderTxt = placeholderText[Language];
        int len = txt.length();
        int margin = round((lenX-4 - len)/2);

        for(unsigned int j=2; j<lenX-2; j++)
            Out[1][j] = ' ';

        if(len>0){
            if(centered){
                for(unsigned int j=2+margin; j<lenX-2; j++){
                    if(i<len){
                        Out[1][j] = txt[i];
                        i++;
                    }
                    else
                        Out[1][j] = ' ';
                }
            }
            else{
                for(int j = 2; j<lenX-3; j++){
                    if(i<len){
                        Out[1][j] = txt[i];
                        i++;
                    }
                    else
                        Out[1][j] = ' ';
                }
            }
        }
        else{
            len = placeholderTxt.length();
            if(centered){
                for(unsigned int j=2+margin; j<lenX-2; j++){
                    if(i<len){
                        Out[1][j] = placeholderTxt[i];
                        i++;
                    }
                }
            }
            else{
                for(int j = 2; j<lenX-3; j++){
                    if(i<len){
                        Out[1][j] = placeholderTxt[i];
                        i++;
                    }
                }
            }
        }
    }

    void printBox(){
        if(visible){
            cout << "\033[" << startY << ";" << startX << "H";
            cout << "\033[7m";
            if(selected)
                cout << "\033[44m";
            for(unsigned int i=0; i<lenY; i++){
                for(unsigned int j=0; j<lenX; j++){
                    cout << Out[i][j];
                }
                cout << "\033[1B" << "\033[" << lenX << "D";
            }
            cout << "\033[0m";
        }
    }

    int getStartX(){
        return startX;
    }

    int getStartY(){
        return startY;
    }

    int getLen(){
        return lenX;
    }

    bool isVisible(){
        return visible;
    }

    void setVisible(bool _visible){
        visible = _visible;
    }

    void setT(Box *box){
        T = box;
    }

    void setR(Box *box){
        R = box;
    }

    void setB(Box *box){
        B = box;
    }

    void setL(Box *box){
        L = box;
    }

    string getType(){
        return type;
    }

    void doAction(){
        changeLang();
    }

    ~LangBox(){
        L = nullptr;
        R = nullptr;
        T = nullptr;
        B = nullptr;

        if (Out != nullptr) {
            for (unsigned int i = 0; i < lenY; ++i) {
                delete[] Out[i];
                Out[i] = nullptr;
            }
            delete[] Out;
            Out = nullptr;
        }
    }
};

class GUI{
private:
    string name;
    Box** boxes;
    unsigned int box_amount, currentBoxes;
    char GUI_OUT[GUIY][GUIX];
public:
    GUI(){}

    GUI(string GUI_name, unsigned int _box_amount){
        name = GUI_name;
        box_amount = _box_amount;
        currentBoxes = 0;
        boxes = new Box*[box_amount];
        for(int i=0; i<box_amount; i++){
            boxes[i] = nullptr;
        }

        generateGUI();
    }

    GUI& operator=(const GUI& gui){
        name = gui.name;
        box_amount = gui.box_amount;
        currentBoxes = 0;
        boxes = new Box*[box_amount];
        for(int i=0; i<box_amount; i++){
            boxes[i] = nullptr;
        }

        generateGUI();
    }

    string getName(){
        return name;
    }

    void printGUI(){
        cout << "\033[7m";
        for(unsigned int i=0; i<GUIY; i++){
            for(unsigned int j=0; j<GUIX; j++){
                if(GUI_OUT[i][j] == '#')
                    cout << "\033[0;30;40m" << GUI_OUT[i][j] << "\033[0;7m";
                else
                    cout<<GUI_OUT[i][j];
            }
            cout<<endl;
        }
        cout << "\033[0m" << endl;

        for(unsigned int i=0; i<box_amount; i++){
            if(boxes[i]!=nullptr)
                boxes[i]->printBox();
        }
    }

    void UpdateGUI(){
        for(int i=0; i<box_amount; i++)
            boxes[i]->setOutputText();
        printGUI();
    }

    void generateGUI(){
        if(name == "START")
            setStartGUI();
        else if(name == "BANK")
            setBankGUI();
        else{
            for(unsigned int i=0; i<GUIY; i++){
                for(unsigned int j=0; j<GUIX; j++){
                    GUI_OUT[i][j] = EmptyGUI[i][j];
                }
            }
        }
    }

    void addBox(Box *box){
        boxes[currentBoxes] = box;
        currentBoxes++;
        //generateBox(box);
    }

    void setStartGUI(){
        for(unsigned int i=0; i<GUIY; i++){
            for(unsigned int j=0; j<GUIX; j++){
                GUI_OUT[i][j] = StartGUI[i][j];
            }
        }
    }

    void setBankGUI(){
        for(unsigned int i=0; i<GUIY; i++){
            for(unsigned int j=0; j<GUIX; j++){
                GUI_OUT[i][j] = BankGUI[i][j];
            }
        }
    }

    void setBoxVisible(unsigned int boxNumber, bool visible){
        boxes[boxNumber]->setVisible(visible);
        //generateBox(boxes[boxNumber]);
    }

    Box *getBox(int number){
        return boxes[number];
    }

    void setBoxNeighbor(unsigned int boxNumber, char side, Box *box){
        if (boxNumber < currentBoxes) {
            switch (side) {
                case 'T':
                    boxes[boxNumber]->setT(box); break;
                case 'B':
                    boxes[boxNumber]->setB(box); break;
                case 'R':
                    boxes[boxNumber]->setR(box); break;
                case 'L':
                    boxes[boxNumber]->setL(box); break;
                default:
                    cout << "Invalid side!" << endl; break;
            }
        } else {
            cout << "Box number out of range!" << endl;
        }
    }

    void setBoxText(unsigned int boxNumber, map<string, string> txt){
        boxes[boxNumber]->setText(txt);
    }

    void showError(map<string, string> err){
        boxes[2]->setText(err);
    }

    ~GUI(){

        cout<<"Deleting boxes..."<<endl;
        for(unsigned int i=0; i<box_amount; i++){
            cout<<i+1<<"-";
            delete boxes[i];
            cout<<"Box deleted!"<<endl;
        }
        delete[] boxes;
        cout<<"Delete complete!"<<endl;
    }
};

///---------------------------------GUIS AND BUTTON------------------------------------------------------------------------------------------------------------------------------------------------

// Current

GUI *currentGUI;
Box *currentBox;

// ATM

GUI *Start;
GUI *InsertCard;
GUI *Choice;
GUI *Deposit;
GUI *Withdraw;
GUI *WithdrawResult;
GUI *CustomWithdraw;
GUI *CustomWithdrawResult;
GUI *TakeOutCard;

// Bank

GUI *Bank;
GUI *Password;
GUI *Admin;
GUI *CasketGUI;

GUI *Login;
GUI *AccountMenu;
GUI *SetMoney;
GUI *DeleteAccountGUI;
GUI *RUSure;
GUI *Cards;
GUI *AddCard;
GUI *DeleteCard;
GUI *Operation;


///---------------------------------FUNCTIONS------------------------------------------------------------------------------------------------------------------------------------------------------

// CHANGE GUI FUNCTIONS

void ChangeGUIToStart(){

    if (Account.is_open()) {
        Account.close();
    }

    currentGUI = Start;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);
}

void ChangeGUIToInsertCard(){
    currentGUI = InsertCard;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);

    currentGUI->showError(insertCardText);
    currentBox->clearInput();
}

void ChangeGUIToChoice(){
    currentGUI = Choice;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);
}

void ChangeGUIToDeposit(){
    currentGUI = Deposit;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);

    currentGUI->showError(depositMoneyText);
    currentBox->clearInput();
}

void ChangeGUIToTakeOutCard(){
    currentGUI = TakeOutCard;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(1);
    currentBox->setSelect(true);
}

void ChangeGUIToWithdraw(){
    currentGUI = Withdraw;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);
}

void ChangeGUIToCustomWithdraw(){
    currentGUI = CustomWithdraw;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);

    currentGUI->showError(withdrawInfoText);
    currentBox->clearInput();
}

void ChangeGUIToWithdrawResult(int ok){
    currentGUI = WithdrawResult;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(2);
    currentBox->setSelect(true);

    if(ok == 1){
        currentGUI->setBoxText(0, successText);
        currentGUI->setBoxText(1, emptyText);
    }
    else if(ok == 2){
        currentGUI->setBoxText(0, failureText);
        currentGUI->setBoxText(1, failureDescText);
    }
    else if(ok == 3){
        currentGUI->setBoxText(0, failureText);
        currentGUI->setBoxText(1, failureDescText2);
    }
    else if(ok == 4){
        currentGUI->setBoxText(0, failureText);
        currentGUI->setBoxText(1, casketMoneyErrorText);
    }
}

void ChangeGUIToBank(){
    currentGUI = Bank;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);
}

void ChangeGUIToPassword(){
    currentGUI = Password;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);

    currentGUI->showError(insertPasswordText);
    currentBox->clearInput();
}

void ChangeGUIToAdmin(){
    currentGUI = Admin;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);
}

void ChangeGUIToCasket(){
    currentGUI = CasketGUI;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);

    currentGUI->showError(setMoneyText);
    currentBox->clearInput();
}

void ChangeGUIToLoginGUI(){
    currentGUI = Login;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);

    currentGUI->showError(insertAccountNumberText);
    currentBox->clearInput();
}

void ChangeGUIToAccountMenu(){
    currentGUI = AccountMenu;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);
}

void ChangeGUIToMoney(){
    currentGUI = SetMoney;
    currentBox->setSelect(false);
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);

    currentGUI->showError(setAccountMoneyText);
    currentBox->clearInput();
}


// BANK FUNCTIONS

void accountReopen(){
    Account.close();
    Account.open(CurrentPath, ios::in | ios::out);
}

bool checkForCard(const string& folderPath, const string& fileName) {
    string searchPath = folderPath + "\\*";
    WIN32_FIND_DATA fd;
    HANDLE hFind = ::FindFirstFile(searchPath.c_str(), &fd);
    if (hFind != INVALID_HANDLE_VALUE) {
        do {
            if (!(fd.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)) {
                if (fd.cFileName == fileName) {
                    string fullPath = folderPath + "\\" + fd.cFileName;
                    Account.open(fullPath, ios::in | ios::out);
                    ::FindClose(hFind);
                    CurrentPath = fullPath;
                    return Account.is_open();
                }
            }
        } while (::FindNextFile(hFind, &fd));
        ::FindClose(hFind);
    }
    return false;
}

string getAccountNumber(const string& filePath) {
    ifstream file(filePath);
    string firstLine = "";
    if (file.is_open()) {
        getline(file, firstLine);
        file.close();
    }
    return firstLine;
}

bool OpenAccount(const string& folderPath1, const string& folderPath2, string Card) {
    Card+=".txt";
    if (checkForCard(folderPath1, Card)) {
        string firstLine = getAccountNumber(folderPath1 + "\\" + Card) + ".txt";
        if (Account.is_open()) {
            Account.close();
        }

        if (checkForCard(folderPath2, firstLine)) {
            return true;
        }
    }
    return false;
}

bool ChangeMoneyOnAccount(int money) { // WIP
    if (!Account.is_open()){
        cout<<CurrentPath;
        Account.open(CurrentPath, ios::in | ios::out);
        if (!Account.is_open()){
            cout<<"Unexpected error during opening account! Please reset ATM.";
            Sleep(1000);
            return false;
        }
    }


    string moneyAmount;
    Account >> moneyAmount;

    double accountMoney;
    accountMoney = stod(moneyAmount);

    if (accountMoney + money < 0) {
        return false;
    } else {
        cout<<endl<<accountMoney<<"+"<<money<<"=";
        accountMoney += money;
        cout<<accountMoney;
        //Sleep(1000);
        //Account.seekp(0, ios::beg);
        accountReopen();
        Account << accountMoney << endl;

        accountReopen();
        return true;
    }
}

void SetMoneyOnAccount(string amount) {
    cout<<amount;
    if(!amount.empty()){
        double money = stod(amount);
        if(money >= 0){
            if (!Account.is_open()){
                Account.open(CurrentPath, ios::in | ios::out);
                if (!Account.is_open()){
                    cout<<"Unexpected error during opening account!";
                    exit(12345);
                }
            }
            Account << money << endl;
            accountReopen();
            currentGUI->showError(moneySetedText);
        }
        else
            currentGUI->showError(notEnoughMoneyText);
    }
}

int amountMoneyInCasket(){
    int amount = 0;

    Casket.open(CasketPath, ios::in | ios::out);
    if (!Casket.is_open()){
        return 0;
    }

    Casket.seekg(0, ios::beg);

    string line;
    while (getline(Casket, line)) {
        size_t dash = line.find("-");

        unsigned int lineType = stoi(line.substr(0, dash));
        int lineAmount, finalAmount;
        lineAmount = stoi(line.substr(dash + 1));
        amount += (lineAmount * lineType);
    }

    Casket.close();
    return amount;

}

bool enoughMoneyInCasket(string amount){
    int casket = amountMoneyInCasket();
    double money = stoi(amount);
    if(money>casket)
        return false;
    return true;
}

double accountFunds(){
    string moneyText;
    getline(Account, moneyText);
    cout<<moneyText;
    double money = stod(moneyText);
    accountReopen();
    return money;
}

void changeMoneyInCasket(unsigned int type, int amount) {
    Casket.open(CasketPath, ios::in | ios::out);
    if (!Casket.is_open()){
        return;
    }

    vector<string> lines;
    string line;
    while (getline(Casket, line)) {
        lines.push_back(line);
    }
    Casket.close();

    for (auto& line : lines) {
        size_t dash = line.find("-");
        if (dash != string::npos) {
            unsigned int lineType = stoi(line.substr(0, dash));
            if (type == lineType) {
                int lineAmount = stoi(line.substr(dash + 1));
                int finalAmount = lineAmount + amount;
                line = to_string(type) + "-" + to_string(finalAmount);
            }
        }
    }

    Casket.open(CasketPath, ios::out | ios::trunc);

    for (const auto& line : lines) {
        Casket << line << endl;
    }

    Casket.close();
}

void moneySeted(bool b){
    if(b)
        currentGUI->showError(moneySetText);
    else
        currentGUI->showError(moneySetErrorText);
}

void setMoneyInCasket(string input) {
    size_t dash = input.find("-");
    if(dash != string::npos){
        string x_str = input.substr(0, dash);
        string y_str = input.substr(dash + 1);

        if (!(x_str.empty() || y_str.empty())){
            int type = stoi(x_str),
                amount = stoi(y_str);

            if(amount >= 0 && (type == 10 || type == 20 || type == 50 || type == 100 || type == 200 || type == 500)){
                Casket.open(CasketPath, ios::in | ios::out);
                if (!Casket.is_open()){
                    return;
                }

                vector<string> lines;
                string line;
                while (getline(Casket, line)) {
                    lines.push_back(line);
                }
                Casket.close();

                for (auto& line : lines) {
                    size_t dash = line.find("-");
                    if (dash != string::npos) {
                        unsigned int lineType = stoi(line.substr(0, dash));
                        if (type == lineType) {
                            line = to_string(type) + "-" + to_string(amount);
                        }
                    }
                }

                Casket.open(CasketPath, ios::out | ios::trunc);

                for (const auto& line : lines) {
                    Casket << line << endl;
                }

                Casket.close();

                moneySeted(true);
            }
            else{
                moneySeted(false);
                return;
            }
        }
        else{
            moneySeted(false);
            return;
        }
    }
    else{
        moneySeted(false);
        return;
    }

}

bool withdrawMoney(string money){ // WIP
    int amount = stoi(money);

    if(amount>accountFunds()){
        return false;
    }
    else{
        int toWithdraw = 0;

        //if(canWithdraw(amount)){
            toWithdraw = amount/500;
            toWithdraw*=(-1);
            changeMoneyInCasket(500, toWithdraw);
            amount += 500*toWithdraw;

            toWithdraw = amount/200;
            toWithdraw*=(-1);
            changeMoneyInCasket(200, toWithdraw);
            amount += 200*toWithdraw;

            toWithdraw = amount/100;
            toWithdraw*=(-1);
            changeMoneyInCasket(100, toWithdraw);
            amount += 100*toWithdraw;

            toWithdraw = amount/50;
            toWithdraw*=(-1);
            changeMoneyInCasket(50, toWithdraw);
            amount += 50*toWithdraw;

            toWithdraw = amount/20;
            toWithdraw*=(-1);
            changeMoneyInCasket(20, toWithdraw);
            amount += 20*toWithdraw;

            toWithdraw = amount/10;
            toWithdraw*=(-1);
            changeMoneyInCasket(10, toWithdraw);
            amount += 10*toWithdraw;
        //}
        //else{
        //    return false;
        //}
    }
    if(amount>0)
        return false;
    else{
        int toSub = stoi(money);
        toSub*=(-1);
        ChangeMoneyOnAccount(toSub);
        return true;
    }
}

// ATM FUNCTIONS

void moneyInserted(bool b){
    if(b)
        currentGUI->showError(moneyInsertedText);
    else
        currentGUI->showError(moneyInsertErrorText);
}

void MoneyInput(string input){
    size_t dash = input.find("-");
    if(dash != string::npos){
        string x_str = input.substr(0, dash);
        string y_str = input.substr(dash + 1);

        if (!(x_str.empty() || y_str.empty())){
            int x = stoi(x_str),
                y = stoi(y_str);

            if (x > 0 && y > 0 && (x == 10 || x == 20 || x == 50 || x == 100 || x == 200 || x == 500)){
                if(ChangeMoneyOnAccount(x*y)){
                    changeMoneyInCasket(x, y);
                    moneyInserted(true);
                }
                else moneyInserted(false);
            }
            else moneyInserted(false);
        }
        else moneyInserted(false);
    }
    else moneyInserted(false);
}

void WithdrawCheck(string amount){
    if(stoi(amount)>0 && stoi(amount)%10 == 0){
        if(enoughMoneyInCasket(amount)){
            if(withdrawMoney(amount))
                ChangeGUIToWithdrawResult(1);
            else
                ChangeGUIToWithdrawResult(2);
        }
        else
            ChangeGUIToWithdrawResult(4);
    }
    else
        ChangeGUIToWithdrawResult(3);
}

void CardInput(string number){

    if(OpenAccount(CardsPath, AccountsPath, number)){
        currentGUI->showError(insertCardText);
        ChangeGUIToChoice();
    }
    else{
        currentGUI->showError(wrongNumberText);
    }
}

void PasswordInput(string pass){
    if(pass == "1324")
        ChangeGUIToAdmin();
    else
        currentGUI->showError(wrongPasswordText);
}

bool CheckForAccount(string number){
    number+=".txt";
    string searchPath = AccountsPath + "\\*";
    WIN32_FIND_DATA fd;
    HANDLE hFind = ::FindFirstFile(searchPath.c_str(), &fd);
    if (hFind != INVALID_HANDLE_VALUE) {
        do {
            if (!(fd.dwFileAttributes & FILE_ATTRIBUTE_DIRECTORY)) {
                if (fd.cFileName == number) {
                    string fullPath = AccountsPath + "\\" + fd.cFileName;
                    Account.open(fullPath, ios::in | ios::out);
                    ::FindClose(hFind);
                    CurrentPath = fullPath;
                    CurrentAccount = number;
                    return Account.is_open();
                }
            }
        } while (::FindNextFile(hFind, &fd));
        ::FindClose(hFind);
    }
    return false;
}

bool OpenAccount(string AccountNumber) {

    if (Account.is_open())
        Account.close();

    if (CheckForAccount(AccountNumber)) {
        return true;
    }
    return false;
}

void AccountInput(string number){

    if(OpenAccount(number)){
        currentGUI->showError(insertAccountNumberText);
        ChangeGUIToAccountMenu();
    }
    else{
        currentGUI->showError(wrongNumberText);
    }
}


// Placeholders

void placeholderAction(){}
void placeholderAction2(string){}


///---------------------------------SETUP---------------------------------------------------------------------------------------------------------------------------------------------------------


// ATM GUIS

void setupStartGUI(){

    Start = new GUI("START", 3);

    Button *insertButton = new Button(16, 10, 17);
    Button *adminButton = new Button(16, 13, 17, true, nullptr, nullptr, nullptr, nullptr, false, true, true);
    LangBox *lang = new LangBox(35, 10, 6);

    insertButton->setText(insertCardText);
    insertButton->setButtonAction(ChangeGUIToInsertCard);
    insertButton->setOutput();

    adminButton->setText(adminText);
    adminButton->setButtonAction(ChangeGUIToBank);
    adminButton->setOutput();

    Start->addBox(insertButton);
    Start->addBox(adminButton);
    Start->addBox(lang);

    Start->setBoxNeighbor(0, 'B', Start->getBox(1));
    Start->setBoxNeighbor(1, 'T', Start->getBox(0));
    Start->setBoxNeighbor(0, 'R', Start->getBox(2));
    Start->setBoxNeighbor(2, 'L', Start->getBox(0));
}

void setupInsertCardGUI(){
    InsertCard = new GUI("INSERT_CARD", 3);
    TextBox *cardTextBox = new TextBox(6, 6, 37);
    TextLabel *cardTextLabel = new TextLabel(16, 10, 17, false, nullptr, nullptr, nullptr, nullptr);
    Button *backToStart = new Button(19, 13, 11);

    cardTextBox->setText(insertCardText);
    cardTextBox->setOutput();

    cardTextLabel->setPlaceholderText(cardNumberText);
    cardTextLabel->setTextLabelAction(CardInput);
    cardTextLabel->setOutput();

    backToStart->setText(backText);
    backToStart->setButtonAction(ChangeGUIToStart);
    backToStart->setOutput();

    InsertCard->addBox(cardTextLabel);
    InsertCard->addBox(backToStart);
    InsertCard->addBox(cardTextBox);

    InsertCard->setBoxNeighbor(0, 'B', InsertCard->getBox(1));
    InsertCard->setBoxNeighbor(1, 'T', InsertCard->getBox(0));
}

void setupChoiceGUI(){
    Choice = new GUI("CHOICE", 3);
    Button *withdrawButton = new Button(9, 10, 14);
    Button *depositButton = new Button(26, 10, 14);
    Button *backToStart = new Button(19, 14, 11);

    depositButton->setText(depositText);
    depositButton->setButtonAction(ChangeGUIToDeposit);
    depositButton->setOutput();

    withdrawButton->setText(withdrawText);
    withdrawButton->setButtonAction(ChangeGUIToWithdraw);
    withdrawButton->setOutput();

    backToStart->setText(exitText);
    backToStart->setButtonAction(ChangeGUIToStart);
    backToStart->setOutput();

    Choice->addBox(withdrawButton);
    Choice->addBox(depositButton);
    Choice->addBox(backToStart);

    Choice->setBoxNeighbor(0, 'R', Choice->getBox(1));
    Choice->setBoxNeighbor(1, 'L', Choice->getBox(0));
    Choice->setBoxNeighbor(0, 'B', Choice->getBox(2));
    Choice->setBoxNeighbor(1, 'B', Choice->getBox(2));
    Choice->setBoxNeighbor(2, 'T', Choice->getBox(0));
}

void setupDepositGUI(){
    Deposit = new GUI("DEPOSIT", 4);
    TextBox *depositMoney = new TextBox(6, 6, 37);
    TextLabel *money = new TextLabel(13, 10, 23, false, nullptr, nullptr, nullptr, nullptr);
    Button *finishButton = new Button(13, 13, 11, true, nullptr, nullptr, nullptr, nullptr, true);
    Button *backButton = new Button(25, 13, 11, true, nullptr, nullptr, nullptr, nullptr, true);

    depositMoney->setText(depositMoneyText);
    depositMoney->setOutput();

    money->setPlaceholderText(insertMoneyText);
    money->setTextLabelAction(MoneyInput);
    money->setOutput();

    finishButton->setText(finishText);
    finishButton->setButtonAction(ChangeGUIToTakeOutCard);
    finishButton->setOutput();

    backButton->setText(backText);
    backButton->setButtonAction(ChangeGUIToChoice);
    backButton->setOutput();

    Deposit->addBox(money);
    Deposit->addBox(finishButton);
    Deposit->addBox(depositMoney);
    Deposit->addBox(backButton);

    Deposit->setBoxNeighbor(0, 'B', Deposit->getBox(1));
    Deposit->setBoxNeighbor(1, 'T', Deposit->getBox(0));
    Deposit->setBoxNeighbor(1, 'R', Deposit->getBox(3));
    Deposit->setBoxNeighbor(3, 'T', Deposit->getBox(0));
    Deposit->setBoxNeighbor(3, 'L', Deposit->getBox(1));
}

void setupTakeOutCardGUI(){

    TakeOutCard = new GUI("TAKE_OUT_CARD", 2);
    TextBox *takeText = new TextBox(13, 9, 23);
    Button *takeOut = new Button(14, 13, 21);

    takeText->setText(endingText);
    takeText->setOutput();

    takeOut->setText(TakeOutCardText);
    takeOut->setButtonAction(ChangeGUIToStart);
    takeOut->setOutput();

    TakeOutCard->addBox(takeText);
    TakeOutCard->addBox(takeOut);
}

void setupWithdrawGUI(){
    Withdraw = new GUI("WITHDRAW", 5);
    Button *w50 = new Button(10, 6, 12, false);
    Button *w100 = new Button(10, 10, 12, false);
    Button *w200 = new Button(27, 6, 12, false);
    Button *custom = new Button(27, 10, 12, false);
    Button *backButton = new Button(19, 14, 11);

    w50->setPlaceholderText("50");
    w50->setText(emptyText);
    w50->setA2(true);
    w50->setButtonAction2(WithdrawCheck);
    w50->setOutput();

    w100->setPlaceholderText("100");
    w100->setText(emptyText);
    w100->setA2(true);
    w100->setButtonAction2(WithdrawCheck);
    w100->setOutput();

    w200->setPlaceholderText("200");
    w200->setText(emptyText);
    w200->setA2(true);
    w200->setButtonAction2(WithdrawCheck);
    w200->setOutput();

    custom->setText(customText);
    custom->setButtonAction(ChangeGUIToCustomWithdraw);
    custom->setOutput();

    backButton->setText(backText);
    backButton->setButtonAction(ChangeGUIToChoice);
    backButton->setOutput();

    Withdraw->addBox(w50);
    Withdraw->addBox(w100);
    Withdraw->addBox(w200);
    Withdraw->addBox(custom);
    Withdraw->addBox(backButton);

    Withdraw->setBoxNeighbor(0, 'R', Withdraw->getBox(2));
    Withdraw->setBoxNeighbor(0, 'B', Withdraw->getBox(1));

    Withdraw->setBoxNeighbor(1, 'R', Withdraw->getBox(3));
    Withdraw->setBoxNeighbor(1, 'T', Withdraw->getBox(0));
    Withdraw->setBoxNeighbor(1, 'B', Withdraw->getBox(4));

    Withdraw->setBoxNeighbor(2, 'L', Withdraw->getBox(0));
    Withdraw->setBoxNeighbor(2, 'B', Withdraw->getBox(3));

    Withdraw->setBoxNeighbor(3, 'T', Withdraw->getBox(2));
    Withdraw->setBoxNeighbor(3, 'L', Withdraw->getBox(1));
    Withdraw->setBoxNeighbor(3, 'B', Withdraw->getBox(4));

    Withdraw->setBoxNeighbor(4, 'T', Withdraw->getBox(1));
}

void setupCustomWithdrawGUI(){
    CustomWithdraw = new GUI("CUSTOM_WITHDRAW", 3);
    TextBox *withdrawInfo = new TextBox(6, 6, 37);
    TextLabel *withdraw = new TextLabel(13, 10, 23, false, nullptr, nullptr, nullptr, nullptr);
    Button *backButton = new Button(19, 13, 11, true, nullptr, nullptr, nullptr, nullptr, true);

    withdrawInfo->setText(withdrawInfoText);
    withdrawInfo->setOutput();

    withdraw->setPlaceholderText(withdrawAmount);
    withdraw->setTextLabelAction(WithdrawCheck);
    withdraw->setOutput();

    backButton->setText(backText);
    backButton->setButtonAction(ChangeGUIToChoice);
    backButton->setOutput();

    CustomWithdraw->addBox(withdraw);
    CustomWithdraw->addBox(backButton);
    CustomWithdraw->addBox(withdrawInfo);

    CustomWithdraw->setBoxNeighbor(0, 'B', CustomWithdraw->getBox(1));
    CustomWithdraw->setBoxNeighbor(1, 'T', CustomWithdraw->getBox(0));
}

void setupWithdrawResultGUI(){
    WithdrawResult = new GUI("WITHDRAW_RESULT", 3);
    TextBox *result = new TextBox(6, 6, 37);
    TextBox *description = new TextBox(5, 9, 39);
    Button *finishButton = new Button(14, 13, 21);

    finishButton->setText(TakeOutCardText);
    finishButton->setButtonAction(ChangeGUIToStart);
    finishButton->setOutput();

    WithdrawResult->addBox(result);
    WithdrawResult->addBox(description);
    WithdrawResult->addBox(finishButton);
}


// BANK GUIS

void setupBankGUI(){
    Bank = new GUI("BANK", 3);
    Button *enter = new Button(16, 10, 17);
    Button *backToStart = new Button(19, 13, 11);
    LangBox *lang = new LangBox(35, 10, 6);

    enter->setText(enterText);
    enter->setButtonAction(ChangeGUIToPassword);
    enter->setOutput();

    backToStart->setText(backText);
    backToStart->setButtonAction(ChangeGUIToStart);
    backToStart->setOutput();

    Bank->addBox(enter);
    Bank->addBox(backToStart);
    Bank->addBox(lang);

    Bank->setBoxNeighbor(0, 'B', Bank->getBox(1));
    Bank->setBoxNeighbor(0, 'R', Bank->getBox(2));
    Bank->setBoxNeighbor(1, 'T', Bank->getBox(0));
    Bank->setBoxNeighbor(2, 'L', Bank->getBox(0));

}

void setupPasswordGUI(){
    Password = new GUI("PASSWORD", 3);
    TextBox *passwordTextBox = new TextBox(6, 6, 37);
    TextLabel *passwordTextLabel = new TextLabel(16, 10, 17, false, nullptr, nullptr, nullptr, nullptr);
    Button *backToBank = new Button(19, 13, 11);

    passwordTextBox->setText(insertPasswordText);
    passwordTextBox->setOutput();

    passwordTextLabel->setPlaceholderText(passwordText);
    passwordTextLabel->setTextLabelAction(PasswordInput);
    passwordTextLabel->setOutput();

    backToBank->setText(backText);
    backToBank->setButtonAction(ChangeGUIToBank);
    backToBank->setOutput();

    Password->addBox(passwordTextLabel);
    Password->addBox(backToBank);
    Password->addBox(passwordTextBox);

    Password->setBoxNeighbor(0, 'B', Password->getBox(1));
    Password->setBoxNeighbor(1, 'T', Password->getBox(0));
}

void setupAdminGUI(){
    Admin = new GUI("ADMIN", 3);
    Button *accountButton = new Button(9, 10, 14);
    Button *casketButton = new Button(26, 10, 14);
    Button *backToBank = new Button(19, 14, 11);

    casketButton->setText(casketText);
    casketButton->setButtonAction(ChangeGUIToCasket);
    casketButton->setOutput();

    accountButton->setText(accountText);
    accountButton->setButtonAction(ChangeGUIToLoginGUI);
    accountButton->setOutput();

    backToBank->setText(backToBankText);
    backToBank->setButtonAction(ChangeGUIToBank);
    backToBank->setOutput();

    Admin->addBox(accountButton);
    Admin->addBox(casketButton);
    Admin->addBox(backToBank);

    Admin->setBoxNeighbor(0, 'R', Admin->getBox(1));
    Admin->setBoxNeighbor(1, 'L', Admin->getBox(0));
    Admin->setBoxNeighbor(0, 'B', Admin->getBox(2));
    Admin->setBoxNeighbor(1, 'B', Admin->getBox(2));
    Admin->setBoxNeighbor(2, 'T', Admin->getBox(0));
}

void setupCasketGUI(){
    CasketGUI = new GUI("CASKET", 3);
    TextBox *changeMoney = new TextBox(6, 6, 37);
    TextLabel *money = new TextLabel(13, 10, 23, false);
    Button *finishButton = new Button(18, 13, 13, true, nullptr, nullptr, nullptr, nullptr, true);

    money->setPlaceholderText(insertMoneyText);
    money->setTextLabelAction(setMoneyInCasket);
    money->setOutput();

    finishButton->setText(finishText);
    finishButton->setButtonAction(ChangeGUIToAdmin);
    finishButton->setOutput();

    changeMoney->setText(setMoneyText);
    changeMoney->setOutput();

    CasketGUI->addBox(money);
    CasketGUI->addBox(finishButton);
    CasketGUI->addBox(changeMoney);

    CasketGUI->setBoxNeighbor(0, 'B', CasketGUI->getBox(1));
    CasketGUI->setBoxNeighbor(1, 'T', CasketGUI->getBox(0));
}

void setupLoginGUI(){
    Login = new GUI("PASSWORD", 3);
    TextBox *numberTextBox = new TextBox(6, 7, 37);
    TextLabel *numberTextLabel = new TextLabel(15, 10, 19, false, nullptr, nullptr, nullptr, nullptr);
    Button *backToBank = new Button(19, 13, 11);

    numberTextBox->setText(insertAccountNumberText);
    numberTextBox->setOutput();

    numberTextLabel->setPlaceholderText(loginText);
    numberTextLabel->setTextLabelAction(AccountInput);
    numberTextLabel->setOutput();

    backToBank->setText(backText);
    backToBank->setButtonAction(ChangeGUIToAdmin);
    backToBank->setOutput();

    Login->addBox(numberTextLabel);
    Login->addBox(backToBank);
    Login->addBox(numberTextBox);

    Login->setBoxNeighbor(0, 'B', Login->getBox(1));
    Login->setBoxNeighbor(1, 'T', Login->getBox(0));
}

void setupAccountMenuGUI(){
    AccountMenu = new GUI("ACCOUNT_MENU", 4);
    Button *moneyButton = new Button(14, 5, 21);
    Button *cardsMenuButton = new Button(14, 8, 21);
    Button *deleteButton = new Button(14, 11, 21);
    Button *exitButton = new Button(14, 14, 21);

    moneyButton->setText(moneyText);
    moneyButton->setButtonAction(ChangeGUIToMoney);
    moneyButton->setOutput();

    cardsMenuButton->setText(cardsMenuText);
    cardsMenuButton->setButtonAction(placeholderAction);//ChangeGUIToCardsMenu
    cardsMenuButton->setOutput();

    deleteButton->setText(deleteText);
    deleteButton->setButtonAction(placeholderAction);//ChangeGUIToDeleteAccount
    deleteButton->setOutput();

    exitButton->setText(exitText);
    exitButton->setButtonAction(ChangeGUIToBank);
    exitButton->setOutput();

    AccountMenu->addBox(moneyButton);
    AccountMenu->addBox(cardsMenuButton);
    AccountMenu->addBox(deleteButton);
    AccountMenu->addBox(exitButton);

    AccountMenu->setBoxNeighbor(0, 'B', AccountMenu->getBox(1));
    AccountMenu->setBoxNeighbor(1, 'T', AccountMenu->getBox(0));
    AccountMenu->setBoxNeighbor(1, 'B', AccountMenu->getBox(2));
    AccountMenu->setBoxNeighbor(2, 'T', AccountMenu->getBox(1));
    AccountMenu->setBoxNeighbor(2, 'B', AccountMenu->getBox(3));
    AccountMenu->setBoxNeighbor(3, 'T', AccountMenu->getBox(2));
}

void setupSetMoneyGUI(){
    SetMoney = new GUI("MONEY", 3);
    TextBox *setMoney = new TextBox(6, 6, 37);
    TextLabel *money = new TextLabel(13, 10, 23, false);
    Button *finishButton = new Button(18, 13, 13, true, nullptr, nullptr, nullptr, nullptr, true);

    money->setPlaceholderText(withdrawAmount);
    money->setTextLabelAction(SetMoneyOnAccount);
    money->setOutput();

    finishButton->setText(finishText);
    finishButton->setButtonAction(ChangeGUIToAccountMenu);
    finishButton->setOutput();

    setMoney->setText(setMoneyText);
    setMoney->setOutput();

    SetMoney->addBox(money);
    SetMoney->addBox(finishButton);
    SetMoney->addBox(setMoney);

    SetMoney->setBoxNeighbor(0, 'B', SetMoney->getBox(1));
    SetMoney->setBoxNeighbor(1, 'T', SetMoney->getBox(0));
}

void setupDeleteAccountGUI(){}

void setupCardsGUI(){}

void setupAddCardGUI(){}

void setupDeleteCardGUI(){}

void setupOperationGUI(){}


// SETUPS

void SETUP_TEXTS(){

// insertCardText
insertCardText["EN"] = "INSERT CARD";
insertCardText["PL"] = "WLOZ KARTE";

// adminText
adminText["EN"] = "ADMIN";
adminText["PL"] = "ADMIN";

// withdrawText
withdrawText["EN"] = "WITHDRAW";
withdrawText["PL"] = "WYPLAC";

// depositText
depositText["EN"] = "DEOPSIT";
depositText["PL"] = "WPLAC";

// exitText
exitText["EN"] = "EXIT";
exitText["PL"] = "WYJDZ";

// backText
backText["EN"] = "BACK";
backText["PL"] = "WROC";

// cardNumberText
cardNumberText["EN"] = "CARD NUMBER";
cardNumberText["PL"] = "NUMER KARTY";

// wrongNumberText
wrongNumberText["EN"] = "INCORRECT NUMBER";
wrongNumberText["PL"] = "NIEPOPRAWNY NUMER";

// depositMoneyText
depositMoneyText["EN"] = "INSERT AMOUNT";
depositMoneyText["PL"] = "PODAJ KWOTE";

// insertMoneyText
insertMoneyText["EN"] = "TYPE-QUANTITY";
insertMoneyText["PL"] = "NOMINAL-ILOSC";

// moneyInsertedText
moneyInsertedText["EN"] = "MONEY DEPOSITED";
moneyInsertedText["PL"] = "WPLACONO PIENIADZE";

// moneyInsertErrorText
moneyInsertErrorText["EN"] = "WRONG INPUT";
moneyInsertErrorText["PL"] = "ZLE WARTOSCI";

// finishText
finishText["EN"] = "FINISH";
finishText["PL"] = "ZAKONCZ";

// endingText
endingText["EN"] = "OPERATION FINISHED";
endingText["PL"] = "OPERACJA ZAKONCZONA";

// customText
customText["EN"] = "CUSTOM";
customText["PL"] = "WLASNE";

// TakeOutCardText
TakeOutCardText["EN"] = "TAKE OUT CARD";
TakeOutCardText["PL"] = "ZABIERZ KARTE";

// withdrawInfoText
withdrawInfoText["EN"] = "INSERT AMOUNT";
withdrawInfoText["PL"] = "PODAJ KWOTE";

// withdrawAmount
withdrawAmount["EN"] = "AMOUNT";
withdrawAmount["PL"] = "WARTOSC";

// successText
successText["EN"] = "OPERATION SUCCESSFUL";
successText["PL"] = "OPERACJA UDANA";

// failureText
failureText["EN"] = "OPERATION FAILED";
failureText["PL"] = "OPERACJA NIEUDANA";

// failureDescText
failureDescText["EN"] = "INSUFFICIENT FUNDS IN THE ACCOUNT";
failureDescText["PL"] = "NIEWYSTARCZAJACE SRODKI NA KONCIE";

// failureDescText2
failureDescText2["EN"] = "WRONG MONEY AMOUNT";
failureDescText2["PL"] = "NIEPRAWIDLOWA ILOSC";

// casketMoneyErrorText
casketMoneyErrorText["EN"] = "INSUFFICIENT FUNDS IN THE CASKET";
casketMoneyErrorText["PL"] = "NIEWYSTARCZAJACE SRODKI W KASETCE";

// bankText
bankText["EN"] = "BANK";
bankText["PL"] = "BANK";

// enterText
enterText["EN"] = "ENTER";
enterText["PL"] = "WEJDZ";

// passwordText
passwordText["EN"] = "PASSWORD";
passwordText["PL"] = "HASLO";

// insertPasswordText
insertPasswordText["EN"] = "INSERT PASSWORD";
insertPasswordText["PL"] = "PODAJ HASLO";

// wrongPasswordText
wrongPasswordText["EN"] = "INCORRECT PASSWORD";
wrongPasswordText["PL"] = "NIEPOPRAWNE HASLO";

// accountText
accountText["EN"] = "ACCOUNTS";
accountText["PL"] = "KONTA";

// casketText
casketText["EN"] = "CASKET";
casketText["PL"] = "KASETKA";

// backToBankText
backToBankText["EN"] = "BACK";
backToBankText["PL"] = "WROC";

// setMoneyText
setMoneyText["EN"] = "SET VALUES";
setMoneyText["PL"] = "USTAW WARTOSCI";

// moneySetText
moneySetText["EN"] = "UPDATED";
moneySetText["PL"] = "USTAWIONO";

// moneySetErrorText
moneySetErrorText["EN"] = "WRONG VALUES";
moneySetErrorText["PL"] = "BLEDNE WARTOSCI";

// insertAccountNumberText
insertAccountNumberText["EN"] = "ENTER ACCOUNT NUMBER";
insertAccountNumberText["PL"] = "PODAJ NUMER KONTA";

// loginText
loginText["EN"] = "ACCOUNT NUMBER";
loginText["PL"] = "NUMER KONTA";

// cardsMenuText
cardsMenuText["EN"] = "MANAGE CARDS";
cardsMenuText["PL"] = "ZARZADZAJ KARTAMI";

// moneyText
moneyText["EN"] = "EDIT BALANCE";
moneyText["PL"] = "EDYTUJ SALDO";

// deleteText
deleteText["EN"] = "DELETE ACCOUNT";
deleteText["PL"] = "USUN KONTO";

// setAccountMoneyText
setAccountMoneyText["EN"] = "SET NEW BALLANCE";
setAccountMoneyText["PL"] = "USTAW NOWE SALDO";

// moneySetedText
moneySetedText["EN"] = "NEW BALLANCE SETED";
moneySetedText["PL"] = "USTAWIONO NOWE SALDO";

// notEnoughMoneyText
notEnoughMoneyText["EN"] = "BALANCE CAN'T BE BELOW 0!";
notEnoughMoneyText["PL"] = "SALDO NIE MOZE BYC MNIEJSZE NIZ 0!";


// emptyText
emptyText["EN"] = "";
emptyText["PL"] = "";
}

void SETUP(){
    cout<<"Setting up ATM:"<<endl<<endl;

    cout<<"Setting texts:";
    SETUP_TEXTS();
    cout<<" - done"<<endl;

    cout<<"StartGUI";
    setupStartGUI();
    cout<<" - done"<<endl<<"InputCardGUI";
    setupInsertCardGUI();
    cout<<" - done"<<endl<<"ChoiceGUI";
    setupChoiceGUI();
    cout<<" - done"<<endl<<"DepositGUI";
    setupDepositGUI();
    cout<<" - done"<<endl<<"TakeOutCardGUI";
    setupTakeOutCardGUI();
    cout<<" - done"<<endl<<"WithdrawGUI";
    setupWithdrawGUI();
    cout<<" - done"<<endl<<"CustomWithdrawGUI";
    setupCustomWithdrawGUI();
    cout<<" - done"<<endl<<"WithdrawResultGUI";
    setupWithdrawResultGUI();
    cout<<" - done"<<endl;

    cout<<endl<<"Setting up Bank:"<<endl<<endl;

    cout<<"BankGUI";
    setupBankGUI();
    cout<<" - done"<<endl<<"setupPasswordGUI";
    setupPasswordGUI();
    cout<<" - done"<<endl<<"setupAdminGUI";
    setupAdminGUI();
    cout<<" - done"<<endl<<"setupCasketGUI";
    setupCasketGUI();
    cout<<" - done"<<endl<<"setupCasketGUI";
    setupCasketGUI();
    cout<<" - done"<<endl<<"setupLoginGUI";
    setupLoginGUI();
    cout<<" - done"<<endl<<"setupAccountMenuGUI";
    setupAccountMenuGUI();
    cout<<" - done"<<endl<<"setupSetMoneyGUI";
    setupSetMoneyGUI();
    cout<<" - done"<<endl<<"setupDeleteAccountGUI";
    setupDeleteAccountGUI();
    cout<<" - done"<<endl<<"setupAddCardGUI";
    setupAddCardGUI();
    cout<<" - done"<<endl<<"setupDeleteCardGUI";
    setupDeleteCardGUI();
    cout<<" - done"<<endl<<"setupOperationGUI";
    setupOperationGUI();
    cout<<" - done";

    cout<<"Setting starting values";
    currentGUI = Admin;
    currentBox = currentGUI->getBox(0);
    currentBox->setSelect(true);
    cout<<" - done"<<endl;

    cout<<endl<<"Setting up finished";
    //for(int i=0; i<3; i++){
    //    cout<<".";
    //    Sleep(1000);
    //}
    system("CLS");
}

void FINISH(){

    cout<< "Closing ATM..."<<endl<<endl;

    // Currents
    currentGUI = nullptr;
    cout << "deleted currentGUI" << endl;
    currentBox = nullptr;
    cout << "deleted currentBox" << endl;

    // ATM
    delete Start;
    cout << "deleted Start" << endl;
    delete InsertCard;
    cout << "deleted InsertCard" << endl;
    delete Choice;
    cout << "deleted Choice" << endl;
    delete Deposit;
    cout << "deleted Deposit" << endl;
    delete Withdraw;
    cout << "deleted Withdraw" << endl;
    delete WithdrawResult;
    cout << "deleted WithdrawResult" << endl;
    delete CustomWithdraw;
    cout << "deleted CustomWithdraw" << endl;
    delete CustomWithdrawResult;
    cout << "deleted CustomWithdrawResult" << endl;
    delete TakeOutCard;
    cout << "deleted TakeOutCard" << endl;

    // Bank
    delete Bank;
    cout << "deleted Bank" << endl;
    delete Password;
    cout << "deleted Password" << endl;
    delete Admin;
    cout << "deleted Admin" << endl;
    delete CasketGUI;
    cout << "deleted CasketGUI" << endl;
    delete Login;
    cout << "deleted Login" << endl;
    delete AccountMenu;
    cout << "deleted AccountMenu" << endl;
    delete SetMoney;
    cout << "deleted SetMoney" << endl;
    delete DeleteAccountGUI;
    cout << "deleted DeleteAccountGUI" << endl;
    delete Cards;
    cout << "deleted Cards" << endl;
    delete AddCard;
    cout << "deleted AddCard" << endl;
    delete DeleteCard;
    cout << "deleted DeleteCard" << endl;
    delete Operation;
    cout << "deleted Operation" << endl;

    // Closing files
    if(Account.is_open())
        Account.close();
        cout << "closed Account" << endl;

    if(Casket.is_open())
        Casket.close();
    cout << "closed Casket" << endl;

    system("cls");

}

///---------------------------------MAIN PROGRAM---------------------------------------------------------------------------------------------------------------------------------------------------

int main(){
    SETUP();

    string backgroundInput = "", admin = "admin", stop = "stop";

    int ic;
    char cc;
    do{
        cout<<"\033[H";
        currentGUI->UpdateGUI();
        cout << "\033[H\033[21B";
        cout << "[" << backgroundInput << "]    " << endl;

        while(!_kbhit()){}
        ic = _getch();
        cc = ic;
        switch(ic)
        {
        case 224:  // Arrows
            switch (_getch())
            {
            case 72: // Up
                currentBox->setSelect(false);
                currentBox = currentBox->Switch('T');
                currentBox->setSelect(true);
                break;
            case 80: // Down
                currentBox->setSelect(false);
                currentBox = currentBox->Switch('B');
                currentBox->setSelect(true);
                break;
            case 75: // Left
                currentBox->setSelect(false);
                currentBox = currentBox->Switch('L');
                currentBox->setSelect(true);
                break;
            case 77: // Right
                currentBox->setSelect(false);
                currentBox = currentBox->Switch('R');
                currentBox->setSelect(true);
                break;
            default:
                break;
            }
        default:
            if(ic == 13){   //  Enter
                currentBox->doAction();
            }

            else if((ic >= 47 && ic <= 57) || ic == 45){  // 0-9 + -
                if(currentBox->getType() == "TextLabel"){
                    currentBox->inputText(cc);
                }
                else{
                    backgroundInput = backgroundInput + cc;
                }
            }

            else if(ic >= 97 && ic <= 122){ //  a-z
                backgroundInput = backgroundInput + cc;
            }

            else if(ic >= 65 && ic <= 90){ //  A-Z
                backgroundInput = backgroundInput + (char)(ic + 32);
            }

            else if(ic == 8){   //  Backspace
                if(currentBox->getType() == "TextLabel"){
                    if(currentBox->getInputedText().length()>0)
                        currentBox->subInputText();
                }
                else{
                    if(backgroundInput.length()>0)
                        backgroundInput.pop_back();
                }
            }
            break;
        }

        if(backgroundInput == admin){
            if(currentGUI->getName() == "START"){
                if(currentGUI->getBox(1)->isVisible())
                    currentGUI->setBoxVisible(1, false);
                else
                    currentGUI->setBoxVisible(1, true);
                backgroundInput = "";
            }
        }

        else{
            if(!(stop.find(backgroundInput) != string::npos)){
                if(!(admin.find(backgroundInput) != string::npos))
                    backgroundInput = cc;
            }
        }
    }
    while(backgroundInput != "stop");

    FINISH();

    return 0;
}

